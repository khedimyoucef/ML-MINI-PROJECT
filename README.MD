# ğŸ›’ Semi-Supervised Grocery Image Classification

A machine learning mini-project that classifies grocery images into 20 categories using semi-supervised learning algorithms.

## ğŸ¯ Project Overview

This project demonstrates the power of **semi-supervised learning** for image classification. The system uses only a small fraction of labeled data combined with a larger pool of unlabeled data to train classifiers that can identify grocery items from images.

### Features
- **20 Grocery Categories**: bacon, banana, bread, broccoli, butter, carrots, cheese, chicken, cucumber, eggs, fish, lettuce, milk, onions, peppers, potatoes, sausages, spinach, tomato, yogurt
- **3 SSL Algorithms**: Label Propagation, Label Spreading, Self-Training
- **Interactive Web App**: Built with Streamlit for easy image classification
- **Pretrained Feature Extraction**: Uses ResNet18 for robust image features

## ğŸš€ Quick Start

### 1. Install Dependencies

```bash
pip install -r requirements.txt
```

### 2. Train Models

```bash
# Train with 10% labeled data (default)
python src/train.py

# Or specify custom labeled ratio
python src/train.py --labeled-ratio 0.2

# Quick test with limited samples
python src/train.py --max-samples 50
```

### 3. Run the Web Application

```bash
streamlit run app.py
```

The app will open in your browser at `http://localhost:8501`

## ğŸ“ Project Structure

```
ML-MINI-PROJECT/
â”œâ”€â”€ DS2GROCERIES/           # Dataset
â”‚   â”œâ”€â”€ train/              # Training images
â”‚   â”œâ”€â”€ test/               # Test images
â”‚   â””â”€â”€ val/                # Validation images
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ data_utils.py       # Data loading utilities
â”‚   â”œâ”€â”€ feature_extraction.py  # ResNet18 feature extractor
â”‚   â”œâ”€â”€ semi_supervised.py  # SSL algorithms
â”‚   â””â”€â”€ train.py            # Training pipeline
â”œâ”€â”€ models/                 # Saved models
â”œâ”€â”€ features/               # Cached feature vectors
â”œâ”€â”€ app.py                  # Streamlit web application
â”œâ”€â”€ requirements.txt        # Python dependencies
â””â”€â”€ README.MD
```

## ğŸ”¬ Semi-Supervised Learning Algorithms

### 1. Label Propagation
A graph-based method that spreads labels through a k-nearest neighbors similarity graph. Labels propagate from labeled to unlabeled samples based on feature similarity.

### 2. Label Spreading
Similar to Label Propagation but uses a normalized graph Laplacian, making it more robust to noise and outliers.

### 3. Self-Training
An iterative approach that:
1. Trains on labeled data
2. Predicts on unlabeled data
3. Adds high-confidence predictions to the training set
4. Repeats until convergence

## ğŸ—ï¸ Technical Architecture

1. **Feature Extraction**: Pretrained ResNet18 (ImageNet weights) extracts 512-dimensional feature vectors from images
2. **Semi-Supervised Classification**: SSL algorithms work on the extracted features to classify images

```
Input Image â†’ ResNet18 â†’ 512-D Features â†’ SSL Algorithm â†’ Grocery Category
```

## ğŸ“Š Usage Examples

### Training with Custom Parameters

```python
from src.train import train_models

# Train with 20% labeled data
results = train_models(
    data_dir="DS2GROCERIES",
    labeled_ratio=0.2,
    algorithms=['label_propagation', 'label_spreading', 'self_training']
)
```

### Making Predictions

```python
from src.feature_extraction import FeatureExtractor
from src.semi_supervised import SemiSupervisedClassifier
from src.data_utils import CLASS_NAMES

# Load models
extractor = FeatureExtractor()
model = SemiSupervisedClassifier.load("models/label_spreading_model.joblib")

# Extract features from image
features = extractor.extract_from_path("path/to/image.jpg")

# Predict
prediction = model.predict(features.reshape(1, -1))
print(f"Predicted: {CLASS_NAMES[prediction[0]]}")
```

## ğŸŒ Web Application

The Streamlit app provides:

- **ğŸ  Home**: Project overview and quick start guide
- **ğŸ” Predict**: Upload images for real-time classification
- **ğŸ“Š Dataset Explorer**: Browse dataset categories and statistics
- **ğŸ“ˆ Model Performance**: Compare algorithm accuracies
- **â„¹ï¸ About**: Technical documentation

## ğŸ“ Requirements

- Python 3.8+
- PyTorch 2.0+
- scikit-learn 1.3+
- Streamlit 1.28+
- See `requirements.txt` for full list

## ğŸ“„ License

This project is for educational purposes (ML Mini-Project).
